---
id: 1527563667
title: Moore NIM 必胜策略
date: 2018-05-29 11:14:27
tags:
  算法
mathjax2: true
---

### 问题描述
Moore Nim 也叫 index-k Nim，这个问题由 Moore 在 1910 年提出，是普通 Nim 问题的扩展，问题的描述如下。

总共有 $n$ 堆石子，每堆石子的个数分别为 $a_1, a_2, a_3 ... a_n$ ，2 个玩家轮流取石子，每次选择 $k$ 堆石子（ $k$ 是固定的数），从中取任意多个石子，而且至少要取一个石子。取走最后一颗石子的获胜，问先手有没有必胜策略。

### 必胜策略
必胜策略显然和每个石子的个数有关，需要分析每堆石子的个数，将每堆石子的初始个数 $a_i$ 写成写成二进制展开形式：
$$
\begin{align}
a_0 &= c_{00} * 2^0 + c_{01} * 2^1 + ... + c_{0m} * 2^m \\
a_1 &= c_{10} * 2^0 + c_{11} * 2^1 + ... + c_{1m} * 2^m \\
    & ... \\
a_n &= c_{n0} * 2^0 + c_{n1} * 2^1 + ... + c_{nm} * 2^m
\end{align}
$$
将上述方程组竖着看，将每一列的系数相加：
$$
\begin{align}
c_0 &= (c_{00} + c_{10} + ... + c_{n0}) mod (k+1) \\
c_1 &= (c_{01} + c_{11} + ... + c_{n1}) mod (k+1)\\
    & ... \\
c_m &= (c_{0m} + c_{1m} + ... + c_{nm}) mod (k+1) \\
\end{align}
$$
如果每一项系数之和 $c_i$ 都等于 $0$，先手必败，否者先手必胜。
也就是说如果每堆石子的二进制展开系数和除以 $(k+1)$ 余数为$0$，先手必败，否则先手必胜。
